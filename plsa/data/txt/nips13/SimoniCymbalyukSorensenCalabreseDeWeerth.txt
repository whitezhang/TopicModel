Development of Hybrid Systems: Interfacing a 
Silicon Neuron to a Leech Heart Interneuron 
Mario F. Simoni 1, Gennady S. Cymbalyuk 2'3, Michael Q. Sorensen 1, 
Ronald L. Calabrese 2, and Stephen P. DeWeerth 1 
1Laboratory for Neuroengineering 
Georgia Institute of Technology 
Atlanta, GA 30332-0363 
{ mario, sorensen, steve.deweerth } @ ece.gatech.edu 
2Department of Biology 
Emory University 
1510 Clifton Road 
Atlanta, GA 30322 
{ gcym, rcalabre } @ biology.emory. edu 
3Institute of Mathematical Problems in Biology RAS 
Pushchino, Moscow Region, Russia 142292 (on leave) 
Abstract 
We have developed a silicon neuron that is inspired by a mathematical 
model of the leech heartbeat (HN) interneuron. The temporal and ionic 
current behaviors of this silicon neuron are close to that of the living 
cell. Because of this similarity we were able to interface this silicon neu- 
ron to a living HN cell using a dynamic clamp technique [8]. We present 
data showing dynamic behaviors of the hybrid half-center oscillator. 
1. Introduction 
The development of hybrid systems, where living neurons are interfaced to electronic cir- 
cuits, is a novel and promising tool to study the complex behaviors of neurosystems. Ana- 
log very large scale integrated (aVLSI) circuits have been used effectively to model the 
behavior of neurosystems in real-time. This technology was applied successfully to model 
individual neurons and small networks of neurons[3][9][10]. These silicon neurons pro- 
vided insight into the dynamic behavior of the living neurons under real world conditions, 
complementing results obtained from mathematical modeling[6] [1 ]. Thus, we believe that 
hybrid systems will provide further insight into mechanisms governing network behavior. 
Our interest in hybrid systems is to develop a better understanding of motor pattern gener- 
ation. The neural network controlling the leech heartbeat is based on two elemental oscil- 
latory systems. Each consists of two reciprocally inhibitory HN neurons, which produce a 
half-center oscillator configuration. These neurons possess dynamics, such as escape and 
release properties, that are appropriate for alternating burst generation in this configura- 
tion [ 11 ] [12]. Furthermore, this oscillatory network and the HN neurons were extensively 
studied, and a detailed mathematical model employing Hodgkin-Huxley formalism was 
developed [5]. 
We are developing the technology to implement a variety of specific neuron models as 
aVLSI circuits. Here, we have designed and fabricated an aVLSI neuron circuit that was 
inspired by the mathematical model of the leech HN cell. In this paper we: 1) describe our 
silicon model of the leech HN cell and its behavior; 2) describe a hybrid half-center oscil- 
lator where the silicon HN cell is coupled with reciprocal inhibition to a living HN cell 
using a dynamic clamp technique[8]; and 3) describe the observed behavior of the hybrid 
system. 
2. Silicon neuron 
Our silicon neuron is inspired by a mathematical model of the leech HN cell that was men- 
tioned previously[5]. This mathematical model consists of a leak conductance and eight 
voltage-gated conductances. To simplify the aVLSI circuits, however, we eliminated two 
of the voltage-gated conductances that are not crucial for producing the desired bursting 
behavior. The silicon neuron consists of seven modules, each with a current output that 
represents one of the seven ionic currents we are modeling: 1) a leak current Icak, 2) a fast 
sodium current INa, 3) an inactivating potassium current 1}: 1 , 4) a slowly activating and 
inactivating calcium current Icas, 5) a slowly activating and non-inactivating potassium 
current 1}: 2 , 6) a persistent sodium current Ip, and 7) a hyperpolarization-activated inward 
current I h .These seven currents are summed onto a capacitor, whose voltage represents 
the membrane potential of the cell. We model a particular ionic current by setting the 
parameters of a module that correspond to biophysical properties of neuronal ionic cur- 
rents such as reversal potential, time constants for activation and inactivation, half-maxi- 
mal values for activation and inactivation, and maximum conductance. 
As shown in Figure 1A the output currents of the seven modules are summed onto capaci- 
tor Cme m tO form the membrane potential Vme m 
dVmem 
Cmem = /leak + INa + Ip + IK1 + IK2 + ICaS + Ih 
(1) 
Figure lB is a circuit schematic of the building blocks we use to model the ionic currents. 
The formal derivation of the equations that describe the aVLSI circuits of the silicon neu- 
ron are found in [4]. Each of the voltage dependent currents consists of an output block 
and at least one of the state blocks depending on the dynamics of the current. The output 
current is described by the following equation where the subscript "ion" should be 
replaced by one of the particular ionic currents described previously 
Iio n = ionZtanh (Sion(Eion - Vmem)) where Z = 
r//ionhion 
I-rm ionI-r hion 
(2) 
where ion represents the maximum ionic current, r//io n and hio n are respectively the acti- 
vation and inactivation states, I.rm ion and I.rh ion are normalization factors for mio n and 
hio n to be discussed later, Sio n = 1/2 S T where r = 0.72 is the gate efficiency of a 
MOSFET and U T = kT?q is the thermal voltage, and Eio n is the reversal potential of the 
current. The leak current uses only an output block and has a slightly different circuits 
from the other currents. Thus, for the leak current, Z = 1 and Sleak ---- r2/(2UT(1 + )) 
in (2). In the case where a current uses only an activation or inactivation state then only the 
respective state with its normalization factor is used. The state_m and state_h blocks 
implement the activation and inactivation states, mio n and hion, as the currents through 
transistors M6 and M9. The dynamics of the states are created by diode-capacitor integra- 
tors consisting of transistor M6 and capacitor C m for O/io n and transistor M9 and capaci- 
tor C h for hio n . The equations that describe the dynamics of these state variables are 
dO/io n fmoo ion- mion' (lClzm ion' 
= qJm ion/' - '/ where qJm ion -- 
dt t. Izm ion J' ['- TT d ø/ion and (3) 
lzm ion 
moo ion ---- (4) 
1 + exp(Aion(V m ion- Vmem)) 
dhio n fhoo ion -- hion' fl(lzh ion " 
d' = qJh ion(' l--h-1o2 'J, where qJh ion- (TT  hiøn and (5) 
hoo ion -- lzh ion (6) 
1 + exp(Bion(Vmem-V h ion)) 
Tm ion and T h ion are the time constants for activation and inactivation. moo ion and boo ion 
represent the steady-state activation and inactivation functions. These functions are imple- 
mented as the output currents of source-degenerated differential pairs, which are sigmoi- 
dal functions of Vme m . It should be noted that moo ion and hoo ion vary between 0 and 
Izm ion and Izh ion respectively, instead of 0 and 1, hence the need to normalize the states 
by these values in (2). Izm ion and lzh ion play two roles: 1) they control the time constants 
for activation and inactivation and 2) they are the maximum values of mio n and hio n . 
Aio n = Bio n = (I(2/(UT(1 + 1())) are inherent properties of the circuits. V m ion and 
Vh ion are the membrane potentials at which moo ion and hoo ion are at half their maximum 
value. The division by Izm ion in (3) and Izh ion in (5) result from factoring these terms to 
show how they affect the time constants.The output block uses an operational transcon- 
ductance amplifier to scale the current lio n by the maximum current ion and account for 
mo 
go 
Vmem 
Teak i TP rl r2 TaX  h 
leak a Na TEK TEK Ca 
>  M2 
I'm ion 
m ion [ Vmem-- 
oo [ h 
V'h 
ønM 
4VN 
I 
I 
I 
M6 M7 I 
mi d8 I 
state_m x _1 
r C h -- 
state_h M 11 
-F 
ion 
M12 
I 
I M13 
Vef 
output 
Figure 1: Schematic of the silicon neuron: A) the seven conductance modules whose cur- 
rents sum on the membrane capacitor; open arrows indicate direction of positive current; 
B) the building blocks of the conductances. 
A 
-40 
B 
,  , 4) 04 
4 8 
time [sec] 
-0 02 
0 002 004 
I.. [nA] 
ml 
Figure 2: A) Membrane potential of the silicon neuron with parameters set for slow wave 
oscillations. B) Dependence of the period of the oscillations on injected current. 
the effects of the reversal potential Eio n as shown in (2). The multiplication and division 
in (2) is performed by transistors M6 through M13 which form a translinear multiplier cir- 
cuit. In the case where the current has only activation the drain of transistor M12 would be 
connected to transistors M7 and M8. For I h we use only a state_h block to create a hyper- 
polarization activated current, in which case the source of M9 is connected to Vrc f . 
The parameters of the silicon neuron are controlled via a pair of digital-to-analog boards 
that we developed, called a PicStack[2]. The PicStack is connected by serial port to a com- 
puter, on which a Java applet creates a graphical user interface for setting the values of the 
D/A channels. This Java applet enables the user to control the parameters in real-time 
while the neuron is operating. Additionally, the applet provides the option to store param- 
eters so that experiments can be repeated. 
A subset of the ionic currents, which have slow dynamics, was shown to be important for 
producing the slow component of the bursting pattern in a half-center configuration 
[5] [12]. Thus, as a starting point in testing the hybrid network, we used only Ih, /CaS, /K2, 
and Ip in the silicon neuron to create the slow waveform that is shown in Figure 2A. The 
leak current for the silicon neuron was implemented with the dynamic clamp where 
Eleak = -100mV and leak = 30nS. The dynamic clamp is an addition to standard elec- 
trophysiological equipment that provides real-time control over the injected current based 
on a user defined function and the measured membrane potential. Figure 2B illustrates the 
relationship between the period and the injected current. If the injected current becomes 
more negative than -0.03nA or more positive than 0.04 nA the oscillations cease. 
3. Hybrid system 
The elemental leech heartbeat pattern generator consists of two HN cells interconnected 
through reciprocal inhibition. To make the hybrid system we replaced one of the HN cells 
with the silicon neuron. A single HN cell was isolated pharmacologically by application of 
bicuculline (lmM)[7]. We then used a dynamic clamp technique to introduce synaptic cur- 
rents between the silicon and living neuron via separate electrometer units (Axoclamp2B, 
Axon Instruments) as shown in Figure 3. The membrane potential of the silicon neuron 
had to be scaled and shifted (we used typical operational amplifier circuits) to fit into the 
+200mV operating range of the dynamic clamp. However, effective currents for the sili- 
con neuron are in the pA to nA range. Thus we connected the electrometer to the silicon 
neuron in a dual-electrode current-clamp mode with the voltage probe connected to the 
scale/shift output and the current electrode directly connected to Cme m of the circuit. The 
electrometer was connected to the living neuron in single-electrode discontinuous-current- 
Figure 3: 
Axoclamp 1 I 
IShtl 
I Axoclamp2 I 
I 
Dynamic Clamp 
Schematic of the hybrid network. 
PicStack 
I 
Laptop 
Computer 
clamp mode to measure the membrane potential and inject the synaptic current. Each of 
the synaptic currents were implemented by the dynamic clamp as 
Isyn = synostS(Esyn- Vmem) and ds 
dt 
1 
syn( 1 -- $oo) (Søø -- $) (7) 
where soo = tanh(G(Vpr½- Vthre)) for Vpre > Vth and ,%o = 0 for Vpr e < Vth. Vth pre 
is the synaptic threshold voltage, Esy n is the synaptic reversal potential, s is the activation 
state of the current, Vpr e is the presynaptic membrane potential, qJsyn is the time constant 
of activation, synost is the maximum synaptic conductance of the postsynaptic neuron. 
The subscripts "pre" and "post" are replaced by "SN" for the silicon neuron and "HN" for 
the living neuron. The multiplication of qJsyn by ( 1 - soo) in (7) effectively creates two dif- 
ferent time constants with a single dynamic equation. 
The artificial leak conductance in the silicon neuron was adjusted so that it produced 
robust autonomous oscillations as shown in Figure 2A. The most important parameters for 
producing robust alternating oscillations in the hybrid network are the presynaptic thresh- 
old, Vth , and the postsynaptic maximal conductance, syn, of the artificial synapses. These 
two parameters affect synaptic strength directly by determining both by the extent of 
threshold crossing by the presynaptic neuron and the maximal response of the postsynap- 
tic neuron. In Figure 4A, oscillations began as soon as the dynamic clamp currents were 
implemented (arrow) and continued for several tens of cycles until the dynamic clamp was 
disabled. The period of the oscillation is longer that the free run period of the silicon neu- 
ron and the duty cycle of the two neurons is roughly equal; thus the system is producing 
true mutual oscillations. The thresholds were set so that the silicon neuron transmitted to 
the HN neuron throughout its depolarized plateau, but only the spikes of the HN neuron 
were transmitted to the silicon neuron. Thus in this configuration, transmission from the 
HN to the silicon neuron is spike mediated, but is graded from the silicon to the HN neu- 
ron. This configuration gave the most robust oscillation in three different preparations. 
Panels B-D of are from a different preparation in which the thresholds of the synapses 
were varied. In B the threshold for the synapse from the HN neuron to the silicon neuron is 
too high for effective transmission and the autonomous oscillation of the silicon neuron 
drives the oscillations without feedback from the HN neuron. The duty cycle of the silicon 
neuron is longer that of the HN neuron. In panel C the threshold for the synapse from the 
silicon neuron to the HN neuron was lowered by 5 mV. Inhibition is more robust leading 
to stronger hyperpolarization of the HN neuron and stronger rebound excitation. The tops 
of the spikes in the HN neuron now cross threshold and there is mild inhibitory feedback 
to the silicon neuron leading to a slightly prolonged period of the system compared to 
panel B. The duty cycle of the two neurons is nearly equal. In panel D the threshold for the 
synapse from the HN neuron to the silicon neuron was lowered. Now spike-mediated 
transmission (HN to SN) is robust (syn had to be lowered slightly or oscillation ceased). 
The period of the system is greatly prolonged and the duty cycle of the HN neuron is pro- 
A 
-25 
-75 
-25 
-75 
c 
T=3.1 s 
2 4 6 8 
time [sec] 
T=2.i s 
;> 
0 ___ _____ 
-50 
=z 
;> 
B 
-25 
-75 
o 
-25 
-75 
o 
-25 
-25 
-5o 
;> 
T=i.5 s 
1 2 3 
time [sec] 
T=8.3 s 
0 2 4 5 10 15 
time [sec] time [sec] 
Figure 4: Plots of the membrane potentials of the silicon, VSN, and living, VHN, neurons 
for different values of Vth and syn' The period, T, of the oscillations is denoted in the 
upper-right of each plot. The dashed lines denote Vth for the synapses. For A qJsyn : 0. i S 
and for B,C, and D qJsyn : 0.2S. The other synaptic parameters are 
A) syn SN : 200nS, syn HN : 50nS, Vth SN : -45mV, and Vth HN : -50mV; 
B) syn SN : 500nS, syn HN : iOnS, Vth SN : -55mY, and Vth HN : -23mV; 
C) syn SN : 500nS, syn HN : iOnS, Vth SN : -60mV, and Vth HN : -23mV; 
D) syn SN : 400nS, syn HN : iOnS, Vth SN : -60mV, and Vth HN = -33mV 
longed with respect to the silicon neuron. Figure 4 indicates that the hybrid system's activ- 
ity is a result of the interaction between the two neurons and is truly hybrid. 
4. Discussion 
We present here a novel hybrid system based on a silicon neuron and the neurons of the 
leech heartbeat pattern generation. Although our silicon neuron was designed to specifi- 
cally model a leech HN cell, the parameters can be altered to obtain various different neu- 
ron properties. Moreover, because the circuit design is modular, the technology is in place 
to fabricate specific models of other types of neurons with minimal effort. The silicon neu- 
ron is portable and can be easily controlled via a computer. The voltage is easily scalable 
and the currents are in the proper range to interface directly with any standard electrophys- 
iological equipment. With this hybrid system we were able to manipulate a living neuron 
to create a pattern generator with user-defined characteristics. 
This work represents the first effort in our progression towards developing and studying 
hybrid systems of more complicated networks. In this paper we have demonstrated that a 
hybrid half-center oscillator can produce robust alternating oscillations, whose period and 
duty cycle are determined by the intrinsic and synaptic properties of both the silicon and 
living neurons. These results encourage further exploration of hybrid systems as a tool for 
studying central pattern generators. We are progressively improving the silicon neuron 
design, including on chip synapses and scaling-amplifiers that will facilitate direct con- 
nections to the living neurons without the aid of a dynamic clamp. We are also developing 
electrode-embedded silicon substrates for culturing neurons so that we can make many 
extracellular connections to large networks of neurons. These particular steps will enable 
the construction and study of multiple cell hybrid networks that have been previously 
unapproachable. 
Acknowledgments 
MFS, MQS, and SPD were supported by NSF grant #IBN-9511721 and a Whitaker Foun- 
dation Biomedical Engineering Research Grant. RLC and GSC are supported by NIH 
grant NS24072. This work was inspired, in part, by collaborations at the NSF Sponsored 
Neuromorphic Engineering Workshop in Telluride, Colorado. Development of the Java 
applet was sponsored by a Sun Microsystems Academic Equipment Grant. 
References 
[1]Cymbalyuk, G.S., Patel, G., Calabrese, R., 
nation to synchrony with inhibitory coupling: 
tion 12 (in press). 
[2]Knight, C.D. (1999) WWW-Based Testing 
Technology. 
[3]Le Masson, G., Le Masson, S., & Moulins, 
Properties: Analysis of Simple Circuits Using 
Biol. 64(2): 201-220. 
DeWeerth, S.P., & Cohen, A. (2000) Modeling alter- 
A neuromorphic VLSI Approach. Neural Computa- 
of Analog Circuits. Ph.D Thesis, Georgia Institute of 
M. (1995) From Conductances to neural Network 
the Hybrid Network Method, Prog. Biophys. molec. 
[4]Mead, C.A. (1989) Analog VLSI and Neural Systems. Addison-Wesley, Reading, Ma. 
[5]Nadim, F., Olsen, O.H., De Schutter, E.,& Calabrese, R.L. (1995) Modeling the leech heartbeat 
elemental oscillator. I. Interactions of intrinsic and synaptic currents. Journal of Computational Neu- 
roscience 2(3):215-235. 
[6]Patel, G., Cymbalyuk, G.S., Calabrese, R.L., & DeWeerth, S.P. (1999) Bifurcation Analysis of a 
Silicon Neuron. In S. A. Solla, T. K. Leen, and K.-R.Mueller (eds.), Advances in Neural Information 
Processing Systems 12. Cambridge, MA: MIT Press. 
[7]Schmidt, J., & Calabrese, R.L. (1992) Evidence that acetylcholine is an inhibitory transmitter of 
heart interneurons in the leech. Journal of Experimental Biology 171:329-47. 
[8]Sharp, A.A., Skinner, F.K., & Marder, E. (1996) Mechanisms of oscillation in dynamic clamp 
constructed two-cell half-center circuits. Journal of Neurophysiology 76 (2):867-883. 
[9]Simoni, M.F., Patel, G.N., DeWeerth, S.P., & Calabrese, R.L. (1997) Analog VLSI Model of the 
Leech Heartbeat Elemental Oscillator. Sixth Annual Computational Neuroscience Meeting. NIH, 
NSF: Big Sky, Montana. 
[10]Simoni, M.F., & DeWeerth, S.P. (1999) Adaptation in an aVLSI Model of a Neuron. IEEE 
Transactions on Circuits and Systems-II: Analog and Digital Signal Processing 46(7):967-970. 
[11]Skinner, F.K., Kopell, N., & Marder, E. (1994) Mechanisms for oscillation and frequency con- 
trol in reciprocally inhibitory model neural networks. Journal of Computational Neurosciences 1:69- 
87. 
[12]Wang, X.J., & Rinzel, J. (1992) Alternating and synchronous rhythms in reciprocally inhibitory 
model neurons. Neural Computation 4:84-87. 
